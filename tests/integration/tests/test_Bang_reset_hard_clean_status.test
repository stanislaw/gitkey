RUN: rm -rf %t
RUN: mkdir -p %t/home %t/repo
RUN: cd %t/repo
RUN: git init -b main
RUN: git config user.name gitkey-test
RUN: git config user.email gitkey-test@example.invalid
RUN: echo "fixture" > README.txt
RUN: git add README.txt
RUN: git commit -m "Initial commit"
RUN: echo "change" >> README.txt
RUN: touch untracked.txt
RUN: %expect_exit 0 bash -c "cd %t/repo && printf '!y\n' | env %gitkey_env $GITKEY_BIN | filecheck %s"

CHECK: git add --intent-to-add .
CHECK: git diff HEAD
CHECK: Creating a patch:
CHECK: {{.*}}/.git/info/gitkey/patches/{{.*}}.patch
CHECK: git reset
CHECK: git reset --hard HEAD
CHECK: git clean -d --force
CHECK: git status
